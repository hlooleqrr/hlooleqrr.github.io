<!-- ÙƒÙˆØ¯ Ø§Ù„Ø­Ø§Ø³Ø¨Ø© Ø§Ù„ÙƒØ§Ù…Ù„ Ø¨Ø¹Ø¯ Ø§Ù„Ø¯Ù…Ø¬ Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ø§Ù„Ù†Ø³Ø®Ø© Ø§Ù„ØªÙŠ ØªØ¹Ù…Ù„ -->
<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <title>Ø­Ø§Ø³Ø¨Ø© Ø§Ù„ØªÙ…ÙˆÙŠÙ„ Ø§Ù„Ø¹Ù‚Ø§Ø±ÙŠ ÙˆØ§Ù„ØªÙ‚Ø§Ø¹Ø¯ÙŠ - Ø³Ø±Ø¹Ø© ØªÙ…Ù„Ùƒ</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <style>
    body { font-family: 'Tajawal', sans-serif; background: #f0f0f0; margin: 0; font-size: 24px; text-align: center; direction: rtl; }
    header { background: #004d40; color: white; padding: 20px; font-size: 30px; font-weight: bold; }
    .container { max-width: 700px; margin: auto; background: white; padding: 30px; margin-top: 40px; border-radius: 10px; box-shadow: 0 0 10px rgba(0,0,0,0.1); }
    label { display: block; margin-top: 25px; font-weight: bold; color: #00695c; }
    input, select { width: 90%; font-size: 22px; padding: 14px; margin-top: 10px; border-radius: 8px; border: 2px solid #80cbc4; }
    button { background: #00796b; color: white; border: none; padding: 18px; font-size: 24px; border-radius: 12px; margin-top: 40px; cursor: pointer; }
    button:hover { background: #004d40; }
    #resultContainer { margin-top: 40px; background: #b2dfdb; padding: 25px; border-radius: 12px; font-weight: bold; font-size: 22px; white-space: pre-line; }
    footer { background: #004d40; color: #a7c7c4; font-size: 16px; padding: 10px; text-align: center; position: fixed; bottom: 0; width: 100%; }
  </style>
</head>
<body>
<header>ðŸ’¼ Ø³Ø±Ø¹Ø© ØªÙ…Ù„Ùƒ Ø§Ù„Ø¹Ù‚Ø§Ø± ÙˆØ§Ù„Ø­Ù„ÙˆÙ„ Ø§Ù„ØªÙ…ÙˆÙŠÙ„ÙŠØ©</header>

<div class="container">
  <div id="questionContainer"></div>
  <button id="nextBtn">Ø§Ù„ØªØ§Ù„ÙŠ</button>
  <div id="resultContainer" style="display:none;"></div>
</div>

<footer>
  ðŸ“… Ù‡Ø¬Ø±ÙŠ: <span id="hijriDate"></span> | Ù…ÙŠÙ„Ø§Ø¯ÙŠ: <span id="gregorianDate"></span>
</footer>

<script>
const today = new Date();
document.getElementById('hijriDate').innerText = new Intl.DateTimeFormat('ar-SA-u-ca-islamic', { day:'numeric', month:'long', year:'numeric' }).format(today);
document.getElementById('gregorianDate').innerText = today.toLocaleDateString('ar-SA');

const questions = [
  { id:'name', label:'Ø§Ø³Ù…Ùƒ Ø§Ù„ÙƒØ±ÙŠÙ…', type:'text' },
  { id:'financeType', label:'Ø§Ø®ØªØ± Ù†ÙˆØ¹ Ø§Ù„ØªÙ…ÙˆÙŠÙ„', type:'select', options:['ØªÙ…ÙˆÙŠÙ„ Ø´Ø®ØµÙŠ Ø£Ùˆ Ø§Ø³ØªÙ‡Ù„Ø§ÙƒÙŠ','ØªÙ…ÙˆÙŠÙ„ Ø¹Ù‚Ø§Ø±ÙŠ'] },
  { id:'jobType', label:'Ù†ÙˆØ¹ Ø§Ù„ÙˆØ¸ÙŠÙØ©', type:'select', options:['Ø¹Ø³ÙƒØ±ÙŠ','Ù…Ø¯Ù†ÙŠ','Ø®Ø§Øµ'] },
  { id:'birthYear', label:'Ø³Ù†Ø© Ø§Ù„Ù…ÙŠÙ„Ø§Ø¯ (Ù‡Ø¬Ø±ÙŠ)', type:'select', options:Array.from({length:80},(_,i)=>1370+i) },
  { id:'militaryRank', label:'Ø§Ø°ÙƒØ± Ø§Ù„Ø±ØªØ¨Ø© Ø§Ù„Ø¹Ø³ÙƒØ±ÙŠØ©', type:'select', options:['Ø¬Ù†Ø¯ÙŠ','Ø¹Ø±ÙŠÙ','ÙˆÙƒÙŠÙ„ Ø±Ù‚ÙŠØ¨','Ø±Ù‚ÙŠØ¨','Ø±Ø¦ÙŠØ³ Ø±Ù‚Ø¨Ø§Ø¡','Ù…Ù„Ø§Ø²Ù…','Ù†Ù‚ÙŠØ¨','Ø±Ø§Ø¦Ø¯','Ù…Ù‚Ø¯Ù…','Ø¹Ù‚ÙŠØ¯','Ø¹Ù…ÙŠØ¯','Ù„ÙˆØ§Ø¡'], show:a=>a.jobType==='Ø¹Ø³ÙƒØ±ÙŠ' },
  { id:'extendedRetirement', label:'Ù‡Ù„ ØªØ±ØºØ¨ Ø¨Ø§Ù„Ø­Ø³Ø¨Ø© Ø¹Ù„Ù‰ Ø§Ù„ØªÙ‚Ø§Ø¹Ø¯ Ø§Ù„Ù…Ù…ØªØ¯ØŸ', type:'select', options:['Ù†Ø¹Ù…','Ù„Ø§'], show:a=>a.jobType==='Ø¹Ø³ÙƒØ±ÙŠ' && a.militaryRank },
  { id:'baseSalary', label:'Ø±Ø§ØªØ¨Ùƒ Ø§Ù„Ø£Ø³Ø§Ø³ÙŠ (Ù„Ù„ØªÙ‚Ø§Ø¹Ø¯ Ø§Ù„Ù…Ù…ØªØ¯)', type:'number', show:a=>a.extendedRetirement==='Ù†Ø¹Ù…' },
  { id:'hireYear', label:'Ø³Ù†Ø© Ø§Ù„ØªØ¹ÙŠÙŠÙ† (Ù‡Ø¬Ø±ÙŠ)', type:'select', options:Array.from({length:40},(_,i)=>1407+i), show:a=>a.extendedRetirement==='Ù†Ø¹Ù…' },
  { id:'salary', label:'Ø±Ø§ØªØ¨Ùƒ Ø§Ù„Ø´Ù‡Ø±ÙŠ Ø§Ù„ØµØ§ÙÙŠ', type:'number' },
  { id:'profitMargin', label:'Ù‡Ø§Ù…Ø´ Ø§Ù„Ø±Ø¨Ø­ Ø§Ù„Ø³Ù†ÙˆÙŠ (%)', type:'number' },
  { id:'months', label:'Ù…Ø¯Ø© Ø§Ù„ØªÙ…ÙˆÙŠÙ„ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø© (Ø¨Ø§Ù„Ø£Ø´Ù‡Ø±)', type:'select', options:Array.from({length:30},(_,i)=>(i+1)*12), format:v=>`${v} Ø´Ù‡Ø± (${v/12} Ø³Ù†ÙˆØ§Øª)` }
];

let step = 0;
let answers = {};

function showQuestion(){
  const q = questions[step];
  if(q.show && !q.show(answers)){ step++; showQuestion(); return; }

  const container = document.getElementById('questionContainer');
  container.innerHTML = `<label>${q.label}</label>`;
  let el;

  if(q.type === 'select'){
    el = document.createElement('select');
    el.innerHTML = `<option value="">-- Ø§Ø®ØªØ± --</option>` + q.options.map(v=>{
      const val = typeof v==='number'?v:v;
      const label = q.format ? q.format(v) : v;
      return `<option value="${val}">${label}</option>`;
    }).join('');
  } else {
    el = document.createElement('input');
    el.type = q.type;
  }

  el.id = q.id;
  el.value = answers[q.id] || '';
  el.oninput = ()=> answers[q.id] = el.value;
  container.appendChild(el);
}

function formatNumber(n){
  return n.toLocaleString('ar-EG');
}

function toYearsText(m){
  const y = Math.floor(m/12);
  const r = m % 12;
  let text = '';
  if(y > 0) text += `${y} Ø³Ù†Ø©`;
  if(r > 0) text += ` Ùˆ${r} Ø´Ù‡Ø±`;
  return text || 'Ø´Ù‡Ø± ÙˆØ§Ø­Ø¯';
}

function showResult(){
  const r = document.getElementById('resultContainer');
  const name = answers.name;
  const salary = +answers.salary;
  const margin = +answers.profitMargin;
  const months = +answers.months;
  const job = answers.jobType;
  const extended = answers.extendedRetirement;
  const base = +answers.baseSalary;
  const hire = +answers.hireYear;
  const birth = +answers.birthYear;
  const now = 1446;

  let percent = answers.financeType.includes('Ø´Ø®ØµÙŠ') ? 0.3333 : 0.55;

  let retirementSalary = null;
  if(job==='Ø¹Ø³ÙƒØ±ÙŠ' && extended==='Ù†Ø¹Ù…'){
    let service = now - hire;
    retirementSalary = (base * service / 40) * 0.55;
    percent = answers.financeType.includes('Ø´Ø®ØµÙŠ') ? 0.25 : 0.55;
  }

  let monthlyInstallment = retirementSalary ? retirementSalary * percent : salary * percent;
  let netFinance = monthlyInstallment * months;
  let totalWithProfit = netFinance * (1 + margin * (months/12) / 100);
  let profit = totalWithProfit - netFinance;

  r.innerHTML = `Ù…Ø±Ø­Ø¨Ø§Ù‹ ÙˆÙ…Ø³Ù‡Ù„Ø§Ù‹ ÙŠØ§ ${name} ðŸ‘‹\n\n` +
    `Ù…Ø¯Ø© Ø§Ù„ØªÙ…ÙˆÙŠÙ„: ${months} Ø´Ù‡Ø± (${toYearsText(months)})\n` +
    (retirementSalary ? `Ø±Ø§ØªØ¨Ùƒ Ø§Ù„ØªÙ‚Ø§Ø¹Ø¯ÙŠ Ø§Ù„Ù…Ø­ØªØ³Ø¨: ${formatNumber(retirementSalary.toFixed(0))} Ø±ÙŠØ§Ù„\n` : '') +
    `Ø§Ù„Ù‚Ø³Ø· Ø§Ù„Ø´Ù‡Ø±ÙŠ Ø§Ù„Ù…Ø³Ù…ÙˆØ­ Ø¨Ù‡: ${formatNumber(monthlyInstallment.toFixed(0))} Ø±ÙŠØ§Ù„\n\n` +
    `Ø§Ù„ØªÙ…ÙˆÙŠÙ„ Ø§Ù„ØµØ§ÙÙŠ: ${formatNumber(netFinance.toFixed(0))} Ø±ÙŠØ§Ù„\n` +
    `Ø§Ù„Ø±Ø¨Ø­ Ø§Ù„ØªÙ‚Ø±ÙŠØ¨ÙŠ: ${formatNumber(profit.toFixed(0))} Ø±ÙŠØ§Ù„\n` +
    `Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ø¨Ù„Øº Ù…Ø¹ Ø§Ù„Ø£Ø±Ø¨Ø§Ø­: ${formatNumber(totalWithProfit.toFixed(0))} Ø±ÙŠØ§Ù„`;

  r.style.display = 'block';
  document.getElementById('nextBtn').style.display = 'none';
}

document.getElementById('nextBtn').onclick = ()=>{
  const q = questions[step];
  const input = document.getElementById(q.id);
  if(input && input.value) answers[q.id] = input.value;
  if(step < questions.length - 1){ step++; showQuestion(); }
  else showResult();
};

showQuestion();
</script>
</body>
</html>