function calculateResult() {
  // Ø¬Ù„Ø¨ Ù‚ÙŠÙ… Ø§Ù„Ø±ØªØ¨Ø© ÙˆØ§Ù„ØªÙˆØ§Ø±ÙŠØ®
  const rank = document.getElementById('rank').value;

  const birthDay = parseInt(document.getElementById('birthDay').value);
  const birthMonth = parseInt(document.getElementById('birthMonth').value);
  const birthYear = parseInt(document.getElementById('birthYear').value);

  const hireDay = parseInt(document.getElementById('hireDay').value);
  const hireMonth = parseInt(document.getElementById('hireMonth').value);
  const hireYear = parseInt(document.getElementById('hireYear').value);

  if (!rank) {
    alert("ÙŠØ±Ø¬Ù‰ Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ø±ØªØ¨Ø© Ø§Ù„Ø¹Ø³ÙƒØ±ÙŠØ©");
    return;
  }

  // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ØµØ­Ø© Ø§Ù„ØªØ§Ø±ÙŠØ® (Ø§Ù„ØªØ¹ÙŠÙŠÙ† Ù„Ø§ ÙŠÙ‚Ù„ Ø¹Ù† Ø§Ù„Ù…ÙŠÙ„Ø§Ø¯)
  if (
    hireYear < birthYear ||
    (hireYear === birthYear && hireMonth < birthMonth) ||
    (hireYear === birthYear && hireMonth === birthMonth && hireDay < birthDay)
  ) {
    alert("ØªØ§Ø±ÙŠØ® Ø§Ù„ØªØ¹ÙŠÙŠÙ† Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø£Ù† ÙŠÙƒÙˆÙ† Ù‚Ø¨Ù„ ØªØ§Ø±ÙŠØ® Ø§Ù„Ù…ÙŠÙ„Ø§Ø¯");
    return;
  }

  // Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø§Ù„ØªØ§Ø±ÙŠØ® Ø§Ù„Ù‡Ø¬Ø±ÙŠ Ø§Ù„Ø­Ø§Ù„ÙŠ (Ø¨ØªÙ†Ø³ÙŠÙ‚ Ø£Ø±Ù‚Ø§Ù…)
  const now = new Date();
  const hijriFormatter = new Intl.DateTimeFormat('ar-SA-u-ca-islamic', {
    year: 'numeric',
    month: 'numeric',
    day: 'numeric'
  });
  const hijriParts = hijriFormatter.formatToParts(now);

  // ØªØ¬Ù…ÙŠØ¹ Ø§Ù„Ø£Ø¬Ø²Ø§Ø¡ ÙÙŠ Ø£Ø±Ù‚Ø§Ù…
  let todayHijri = { y: 0, m: 0, d: 0 };
  hijriParts.forEach(part => {
    if (part.type === 'year') todayHijri.y = parseInt(part.value);
    if (part.type === 'month') todayHijri.m = parseInt(part.value);
    if (part.type === 'day') todayHijri.d = parseInt(part.value);
  });

  // Ø¯ÙˆØ§Ù„ Ù…Ø³Ø§Ø¹Ø¯Ø© Ø­Ø³Ø§Ø¨ÙŠØ© (ØªØ³ØªØ®Ø¯Ù… ØªÙ‚Ø±ÙŠØ¨Ø§Øª Ø¨Ø³ÙŠØ·Ø© Ù„Ø£Ù† Ø§Ù„ØªÙ‚ÙˆÙŠÙ… Ø§Ù„Ù‡Ø¬Ø±ÙŠ ØºÙŠØ± Ø«Ø§Ø¨Øª 100%)
  function hijriToDays(y, m, d) {
    return y * 354 + (m - 1) * 29.5 + d;
  }

  function diffHijri(y1, m1, d1, y2, m2, d2) {
    let diff = Math.floor(hijriToDays(y2, m2, d2) - hijriToDays(y1, m1, d1));
    if (diff < 0) diff = 0;
    const years = Math.floor(diff / 354);
    diff -= years * 354;
    const months = Math.floor(diff / 29.5);
    diff -= months * 29.5;
    const days = Math.floor(diff);
    return { years, months, days };
  }

  // Ø­Ø³Ø§Ø¨ Ù…Ø¯Ø© Ø§Ù„Ø®Ø¯Ù…Ø©
  const serviceDuration = diffHijri(hireYear, hireMonth, hireDay, todayHijri.y, todayHijri.m, todayHijri.d);
  const serviceYearsDecimal = serviceDuration.years + serviceDuration.months / 12 + serviceDuration.days / 365;

  // Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø±ØªØ¨ ÙƒÙ…Ø§ ÙÙŠ Ø§Ù„ÙƒÙˆØ¯ Ø§Ù„Ø£Ø³Ø§Ø³ÙŠ
  const ranksData = {
    "Ø¬Ù†Ø¯ÙŠ": { base: 3220, allowance: 125, maxYears: 15, retireAge: 44 },
    "Ø¬Ù†Ø¯ÙŠ Ø£ÙˆÙ„": { base: 3395, allowance: 135, maxYears: 15, retireAge: 44 },
    "Ø¹Ø±ÙŠÙ": { base: 3765, allowance: 150, maxYears: 15, retireAge: 46 },
    "ÙˆÙƒÙŠÙ„ Ø±Ù‚ÙŠØ¨": { base: 4455, allowance: 180, maxYears: 15, retireAge: 46 },
    "Ø±Ù‚ÙŠØ¨": { base: 5260, allowance: 215, maxYears: 15, retireAge: 48 },
    "Ø±Ù‚ÙŠØ¨ Ø£ÙˆÙ„": { base: 6180, allowance: 260, maxYears: 15, retireAge: 50 },
    "Ø±Ø¦ÙŠØ³ Ø±Ù‚Ø¨Ø§Ø¡": { base: 7215, allowance: 310, maxYears: 15, retireAge: 52 },
    "Ù…Ù„Ø§Ø²Ù…": { base: 7590, allowance: 380, maxYears: 15, retireAge: 48 },
    "Ù…Ù„Ø§Ø²Ù… Ø£ÙˆÙ„": { base: 8365, allowance: 395, maxYears: 15, retireAge: 50 },
    "Ù†Ù‚ÙŠØ¨": { base: 9215, allowance: 230, maxYears: 15, retireAge: 52 },
    "Ø±Ø§Ø¦Ø¯": { base: 11705, allowance: 230, maxYears: 15, retireAge: 54 },
    "Ù…Ù‚Ø¯Ù…": { base: 12735, allowance: 230, maxYears: 15, retireAge: 55 },
    "Ø¹Ù‚ÙŠØ¯": { base: 14365, allowance: 230, maxYears: 15, retireAge: 56 },
    "Ø¹Ù…ÙŠØ¯": { base: 16350, allowance: 210, maxYears: 15, retireAge: 57 },
    "Ù„ÙˆØ§Ø¡": { base: 18600, allowance: 200, maxYears: 15, retireAge: 58 }
  };

  const maxAllowanceYears = ranksData[rank].maxYears;
  const allowanceYears = Math.min(serviceDuration.years, maxAllowanceYears);

  const baseSalary = ranksData[rank].base + allowanceYears * ranksData[rank].allowance;

  const pension = Math.round((baseSalary * serviceYearsDecimal * 0.55) / 40);

  // Ø­Ø³Ø§Ø¨ Ù…ÙˆØ¹Ø¯ Ø§Ù„ØªÙ‚Ø§Ø¹Ø¯: Ø§Ù„Ù…ÙŠÙ„Ø§Ø¯ + Ø§Ù„Ø¹Ù…Ø± Ø§Ù„ØªÙ‚Ø§Ø¹Ø¯ÙŠ
  function addMonthsHijri(y, m, d, monthsToAdd) {
    m += monthsToAdd;
    while (m > 12) {
      m -= 12;
      y++;
    }
    return { y, m, d };
  }
  const retireAge = ranksData[rank].retireAge;
  const retireDate = addMonthsHijri(birthYear, birthMonth, birthDay, retireAge * 12);

  // Ø¨Ø§Ù‚ÙŠ Ø§Ù„ÙˆÙ‚Øª Ø­ØªÙ‰ Ø§Ù„ØªÙ‚Ø§Ø¹Ø¯
  const timeToRetire = diffHijri(todayHijri.y, todayHijri.m, todayHijri.d, retireDate.y, retireDate.m, retireDate.d);

  // Ø¹Ù…Ø± Ø§Ù„Ù…ØªÙ‚Ø§Ø¹Ø¯ Ø¹Ù†Ø¯ Ø§Ù„ØªÙ‚Ø§Ø¹Ø¯
  function calculateAge(birthY, birthM, birthD, currentY, currentM, currentD) {
    let years = currentY - birthY;
    let months = currentM - birthM;
    let days = currentD - birthD;
    if (days < 0) {
      days += 30;
      months--;
    }
    if (months < 0) {
      months += 12;
      years--;
    }
    return { years, months, days };
  }
  const ageAtRetire = calculateAge(birthYear, birthMonth, birthDay, retireDate.y, retireDate.m, retireDate.d);

  // Ø¹Ø±Ø¶ Ø§Ù„Ù†ØªØ§Ø¦Ø¬ Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠØ©
  const resultText = `
    <p>ğŸ–ï¸ <strong>Ø§Ù„Ø±ØªØ¨Ø©:</strong> ${rank}</p>
    <p>ğŸ“† <strong>Ù…Ø¯Ø© Ø§Ù„Ø®Ø¯Ù…Ø© Ø­ØªÙ‰ Ø§Ù„ÙŠÙˆÙ…:</strong> ${serviceDuration.years} Ø³Ù†Ø©ØŒ ${serviceDuration.months} Ø´Ù‡Ø±ØŒ Ùˆ${serviceDuration.days} ÙŠÙˆÙ…</p>
    <p>ğŸ’¼ <strong>Ø§Ù„Ø±Ø§ØªØ¨ Ø§Ù„Ø£Ø³Ø§Ø³ÙŠ Ø§Ù„Ø­Ø§Ù„ÙŠ (ØªÙ‚Ø¯ÙŠØ±ÙŠ):</strong> ${baseSalary.toLocaleString('ar-EG')} Ø±ÙŠØ§Ù„</p>
    <p>ğŸ’° <strong>Ø§Ù„Ø±Ø§ØªØ¨ Ø§Ù„ØªÙ‚Ø§Ø¹Ø¯ÙŠ Ø§Ù„Ù…ØªÙˆÙ‚Ø¹:</strong> ${pension.toLocaleString('ar-EG')} Ø±ÙŠØ§Ù„</p>
    <hr>
    <p>â³ <strong>Ø¨Ø§Ù‚ÙŠ Ø¹Ù„Ù‰ Ø§Ù„ØªÙ‚Ø§Ø¹Ø¯:</strong> ${timeToRetire.years} Ø³Ù†Ø©ØŒ ${timeToRetire.months} Ø´Ù‡Ø±ØŒ Ùˆ${timeToRetire.days} ÙŠÙˆÙ…</p>
    <p>ğŸ“… <strong>Ù…ÙˆØ¹Ø¯ Ø§Ù„ØªÙ‚Ø§Ø¹Ø¯ Ø§Ù„Ù…ØªÙˆÙ‚Ø¹ (Ù‡Ø¬Ø±ÙŠ):</strong> ${retireDate.y} / ${retireDate.m} / ${retireDate.d}</p>
    <p>ğŸ‘´ <strong>Ø¹Ù…Ø± Ø§Ù„Ù…ØªÙ‚Ø§Ø¹Ø¯ Ø§Ù„Ù…ØªÙˆÙ‚Ø¹:</strong> ${ageAtRetire.years} Ø³Ù†Ø©ØŒ ${ageAtRetire.months} Ø´Ù‡Ø±ØŒ Ùˆ${ageAtRetire.days} ÙŠÙˆÙ…</p>
  `;

  const resultDiv = document.getElementById('result');
  resultDiv.innerHTML = resultText;
  resultDiv.style.display = 'block';

  prevBtn.style.display = 'none';
  nextBtn.style.display = 'none';
}