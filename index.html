<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Ø­Ø§Ø³Ø¨Ø© Ø§Ù„ØªÙ…ÙˆÙŠÙ„ Ø§Ù„Ø¹Ù‚Ø§Ø±ÙŠ ÙˆØ§Ù„ØªÙ‚Ø§Ø¹Ø¯ÙŠ - Ø³Ø±Ø¹Ø© ØªÙ…Ù„Ùƒ Ø§Ù„Ø¹Ù‚Ø§Ø±</title>
<style>
  body {
    font-family: 'Tajawal', sans-serif;
    background: linear-gradient(135deg, #e0f2f1, #ffffff);
    margin: 0; padding: 0;
    min-height: 100vh; display: flex;
    flex-direction: column; align-items: center;
    color: #012a26; text-align: center;
  }
  header {
    background: #005c48; color: #fff;
    padding: 25px; font-size: 32px; width: 100%;
  }
  .container {
    background: #fff; margin: 30px auto;
    padding: 30px; border-radius: 12px;
    box-shadow: 0 0 20px rgba(0,0,0,0.1);
    width: 95%; max-width: 700px;
  }
  label { font-size: 26px; color: #00695c; margin-top: 20px; display:block; }
  input, select {
    font-size: 24px; padding: 14px;
    width: 90%; max-width: 450px;
    margin: 12px auto; display: block;
    border: 2px solid #b2dfdb; border-radius: 8px;
    color: #004d40; font-weight: 600;
  }
  button {
    font-size: 26px; padding: 16px 0;
    width: 90%; max-width: 450px;
    margin: 30px auto; border:none;
    border-radius: 12px; background: #00796b;
    color: #fff; cursor: pointer;
    box-shadow: 0 6px 15px rgba(0,121,107,0.6);
  }
  button:disabled { background: #a5d6a7; cursor: default; }
  button:hover:not(:disabled) { background: #004d40; }
  #result { background: #b2dfdb; padding: 25px;
    border-radius: 12px; font-size:24px;
    color: #004d40; line-height: 1.6;
    white-space: pre-line; margin-top: 20px;
  }
  footer {
    margin-top: auto; padding: 20px;
    font-size: 18px; color: #666;
  }
</style>
</head>
<body>
<header>Ø³Ø±Ø¹Ø© ØªÙ…Ù„Ùƒ Ø§Ù„Ø¹Ù‚Ø§Ø± ÙˆØ§Ù„Ø­Ù„ÙˆÙ„ Ø§Ù„ØªÙ…ÙˆÙŠÙ„ÙŠØ©</header>
<div class="container">
  <button id="startBtn">Ø§Ø¨Ø¯Ø£ Ø§Ù„Ø­Ø³Ø¨Ø©</button>
  <div id="form" style="display:none;">
    <label>Ø§Ø®ØªØ± Ù†ÙˆØ¹ Ø§Ù„ØªÙ…ÙˆÙŠÙ„:</label>
    <select id="financeType">
      <option value="">-- Ø§Ø®ØªØ± --</option>
      <option value="real">ØªÙ…ÙˆÙŠÙ„ Ø¹Ù‚Ø§Ø±ÙŠ</option>
      <option value="personal">ØªÙ…ÙˆÙŠÙ„ Ø´Ø®ØµÙŠ</option>
    </select>
    <label>Ù†ÙˆØ¹ Ø§Ù„ÙˆØ¸ÙŠÙØ©:</label>
    <select id="jobType">
      <option value="">-- Ø§Ø®ØªØ± --</option>
      <option value="military">Ø¹Ø³ÙƒØ±ÙŠ</option>
      <option value="civil">Ù…Ø¯Ù†ÙŠ</option>
      <option value="private">Ø®Ø§Øµ</option>
    </select>
    <label>Ø³Ù†Ø© Ø§Ù„Ù…ÙŠÙ„Ø§Ø¯ (Ù‡Ø¬Ø±ÙŠ):</label>
    <input type="number" id="birthYear" placeholder="Ù…Ø«Ø§Ù„: 1406" min="1300" max="1450"/>
    <div id="rankSection" style="display:none;">
      <label>Ø±ØªØ¨ØªÙƒ Ø§Ù„Ø¹Ø³ÙƒØ±ÙŠØ©:</label>
      <select id="rank"><option value="">-- Ø§Ø®ØªØ± --</option>
        <option>Ø¬Ù†Ø¯ÙŠ</option><option>Ø¬Ù†Ø¯ÙŠ Ø£ÙˆÙ„</option><option>Ø¹Ø±ÙŠÙ</option><option>ÙˆÙƒÙŠÙ„ Ø±Ù‚ÙŠØ¨</option>
        <option>Ø±Ù‚ÙŠØ¨</option><option>Ø±Ù‚ÙŠØ¨ Ø£ÙˆÙ„</option><option>Ø±Ø¦ÙŠØ³ Ø±Ù‚Ø¨Ø§Ø¡</option>
        <option>Ù…Ù„Ø§Ø²Ù…</option><option>Ù…Ù„Ø§Ø²Ù… Ø£ÙˆÙ„</option><option>Ù†Ù‚ÙŠØ¨</option>
        <option>Ø±Ø§Ø¦Ø¯</option><option>Ù…Ù‚Ø¯Ù…</option><option>Ø¹Ù‚ÙŠØ¯</option>
        <option>Ø¹Ù…ÙŠØ¯</option><option>Ù„ÙˆØ§Ø¡</option>
      </select>
    </div>
    <label>Ø§Ù„Ø±Ø§ØªØ¨ Ø§Ù„ØµØ§ÙÙŠ Ø§Ù„Ø­Ø§Ù„ÙŠ:</label>
    <input type="number" id="netSalary" placeholder="Ù…Ø«Ø§Ù„: 10000"/>
    <label>Ù‡Ø§Ù…Ø´ Ø§Ù„Ø±Ø¨Ø­ Ø§Ù„Ø³Ù†ÙˆÙŠ (%):</label>
    <input type="number" id="profitMargin" placeholder="Ù…Ø«Ø§Ù„: 4"/>
    <button id="nextBtn" disabled>Ø§Ù„ØªØ§Ù„ÙŠ</button>
  </div>
  <div id="result" style="display:none;"></div>
</div>
<footer>
  ğŸ“… Ù‡Ø¬Ø±ÙŠ: <span id="hijri"></span> | Ù…ÙŠÙ„Ø§Ø¯ÙŠ: <span id="greg"></span><br />
  Â© Ø³Ø±Ø¹Ø© ØªÙ…Ù„Ùƒ Ø§Ù„Ø¹Ù‚Ø§Ø± ÙˆØ§Ù„Ø­Ù„ÙˆÙ„ Ø§Ù„ØªÙ…ÙˆÙŠÙ„ÙŠØ©
</footer>
<script>
  const today=new Date();
  document.getElementById('greg').innerText=today.toLocaleDateString('ar-EG');
  document.getElementById('hijri').innerText=new Intl.DateTimeFormat('ar-SA-u-ca-islamic',{day:'numeric',month:'long',year:'numeric'}).format(today);

  const startBtn=document.getElementById('startBtn');
  const form=document.getElementById('form');
  const financeType=document.getElementById('financeType');
  const jobType=document.getElementById('jobType');
  const birthYear=document.getElementById('birthYear');
  const rankSection=document.getElementById('rankSection');
  const rankSel=document.getElementById('rank');
  const netSalary=document.getElementById('netSalary');
  const profitMargin=document.getElementById('profitMargin');
  const nextBtn=document.getElementById('nextBtn');
  const resultDiv=document.getElementById('result');

  const retireAges = {
    'Ø¬Ù†Ø¯ÙŠ':44,'Ø¬Ù†Ø¯ÙŠ Ø£ÙˆÙ„':44,'Ø¹Ø±ÙŠÙ':46,'ÙˆÙƒÙŠÙ„ Ø±Ù‚ÙŠØ¨':48,'Ø±Ù‚ÙŠØ¨':48,
    'Ø±Ù‚ÙŠØ¨ Ø£ÙˆÙ„':50,'Ø±Ø¦ÙŠØ³ Ø±Ù‚Ø¨Ø§Ø¡':52,'Ù…Ù„Ø§Ø²Ù…':48,'Ù…Ù„Ø§Ø²Ù… Ø£ÙˆÙ„':50,
    'Ù†Ù‚ÙŠØ¨':52,'Ø±Ø§Ø¦Ø¯':54,'Ù…Ù‚Ø¯Ù…':56,'Ø¹Ù‚ÙŠØ¯':58,'Ø¹Ù…ÙŠØ¯':60,'Ù„ÙˆØ§Ø¡':60
  };

  const salaryGrades = {
    'Ø¬Ù†Ø¯ÙŠ':{base:3220,inc:125},'Ø¬Ù†Ø¯ÙŠ Ø£ÙˆÙ„':{base:3395,inc:135},
    'Ø¹Ø±ÙŠÙ':{base:3715,inc:140},'ÙˆÙƒÙŠÙ„ Ø±Ù‚ÙŠØ¨':{base:4000,inc:150},
    'Ø±Ù‚ÙŠØ¨':{base:4370,inc:160},'Ø±Ù‚ÙŠØ¨ Ø£ÙˆÙ„':{base:4700,inc:165},
    'Ø±Ø¦ÙŠØ³ Ø±Ù‚Ø¨Ø§Ø¡':{base:4950,inc:170},'Ù…Ù„Ø§Ø²Ù…':{base:8835,inc:275},
    'Ù…Ù„Ø§Ø²Ù… Ø£ÙˆÙ„':{base:9715,inc:350},'Ù†Ù‚ÙŠØ¨':{base:11940,inc:450},
    'Ø±Ø§Ø¦Ø¯':{base:14155,inc:500},'Ù…Ù‚Ø¯Ù…':{base:16400,inc:600},
    'Ø¹Ù‚ÙŠØ¯':{base:18800,inc:700},'Ø¹Ù…ÙŠØ¯':{base:22000,inc:800},'Ù„ÙˆØ§Ø¡':{base:23500,inc:900}
  };

  startBtn.onclick=()=>{
    startBtn.style.display='none';
    form.style.display='block';
    nextBtn.disabled=true;
  };

  jobType.onchange=()=>{
    if(jobType.value==='military') rankSection.style.display='block';
    else {
      rankSection.style.display='none';
      rankSel.value='';
    }
    validate();
  };

  [financeType,jobType,birthYear,netSalary,profitMargin,rankSel].forEach(el=>{
    el.oninput=validate;
    el.onchange=validate;
  });

  function validate(){
    let ok=financeType.value&&jobType.value&&birthYear.value&&netSalary.value&&profitMargin.value;
    if(jobType.value==='military') ok=ok&&rankSel.value;
    nextBtn.disabled=!ok;
  }

  nextBtn.onclick=()=>{
    const fin=financeType.value;
    const job=jobType.value;
    const by=+birthYear.value;
    const sal=+netSalary.value;
    const prof=+profitMargin.value/100;

    const monthsLived=(1446-by)*12;
    let retAge=job==='military'?retireAges[rankSel.value]:60;
    const retireMonths=retAge*12;
    const monthsLeft=retireMonths-monthsLived;

    let extended=false;
    if((fin==='real'&&job==='military'&&monthsLeft<300)||
       (fin==='personal'&&monthsLeft<60)){
      extended=confirm('Ù‡Ù„ ØªØ±ØºØ¨ Ø¨Ø§Ù„Ø­Ø³Ø¨Ø© Ø¹Ù„Ù‰ Ø§Ù„ØªÙ‚Ø§Ø¹Ø¯ Ø§Ù„Ù…Ù…ØªØ¯ØŸ');
    }

    let pension=0;
    if(job==='military'&&extended){
      const serviceYears=Math.min(Math.floor(monthsLived/12),15);
      const {base,inc}=salaryGrades[rankSel.value];
      const bs=base+inc*(serviceYears-1);
      pension=bs*serviceYears/40*0.55;
    }

    const beforeRate=fin==='personal'?0.3333:0.55;
    const afterRate=fin==='personal'?0.25:0.55;
    const totalMonths=extended?monthsLeft:(fin==='personal'?Math.min(monthsLeft,60):monthsLeft);
    const beforeMonths=extended?monthsLeft:totalMonths;
    const afterMonths=extended?totalMonths-monthsLeft:0;
    const beforeInst=Math.round(sal*beforeRate);
    const afterInst=Math.round(pension*afterRate);
    const totalInst=beforeInst*beforeMonths+afterInst*afterMonths;
    const profit=Math.round(totalInst*prof);
    const net=totalInst-profit;

    let txt=`Ù…Ø±Ø­Ø¨Ø§Ù‹ ÙˆÙ…Ø³Ù‡Ù„Ø§Ù‹ ÙŠØ§ ${job==='military'?rankSel.value+' ':''}Ø§Ù„Ø¹Ù…ÙŠÙ„\n`;
    txt+=`Ù†ÙˆØ¹ Ø§Ù„ØªÙ…ÙˆÙŠÙ„: ${fin==='real'?'Ø¹Ù‚Ø§Ø±ÙŠ':'Ø´Ø®ØµÙŠ'}\n`;
    txt+=`Ù…Ø¯Ø© Ø§Ù„ØªÙ…ÙˆÙŠÙ„: ${totalMonths} Ø´Ù‡Ø±\n`;
    txt+=`Ø§Ù„Ù‚Ø³Ø· Ù‚Ø¨Ù„ Ø§Ù„ØªÙ‚Ø§Ø¹Ø¯ (${beforeMonths} Ø´Ù‡Ø±): ${beforeInst.toLocaleString()} Ø±ÙŠØ§Ù„\n`;
    if(afterMonths>0) txt+=`Ø§Ù„Ù‚Ø³Ø· Ø¨Ø¹Ø¯ Ø§Ù„ØªÙ‚Ø§Ø¹Ø¯ (${afterMonths} Ø´Ù‡Ø±): ${afterInst.toLocaleString()} Ø±ÙŠØ§Ù„\n`;
    txt+=`\nØ§Ù„ØªÙ…ÙˆÙŠÙ„ Ø§Ù„ØµØ§ÙÙŠ: ${net.toLocaleString()} Ø±ÙŠØ§Ù„\n`;
    txt+=`Ø§Ù„Ø±Ø¨Ø­: ${profit.toLocaleString()} Ø±ÙŠØ§Ù„\n`;

    resultDiv.innerText=txt;
    resultDiv.style.display='block';
  };
</script>
</body>
</html>