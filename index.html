<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Ø­Ø§Ø³Ø¨Ø© Ø§Ù„ØªÙ…ÙˆÙŠÙ„ Ø§Ù„Ø¹Ù‚Ø§Ø±ÙŠ ÙˆØ§Ù„ØªÙ‚Ø§Ø¹Ø¯ÙŠ - Ø³Ø±Ø¹Ø© ØªÙ…Ù„Ùƒ Ø§Ù„Ø¹Ù‚Ø§Ø±</title>
<style>
  body {
    font-family: 'Tajawal', sans-serif;
    background: linear-gradient(135deg, #e0f2f1, #ffffff);
    margin: 0; min-height: 100vh;
    display: flex; flex-direction: column; align-items: center;
    color: #012a26; text-align: center;
  }
  header {
    background: #005c48; color: white;
    font-weight: 900; font-size: 32px;
    padding: 28px 12px;
    width: 100%;
    text-align: center;
    box-shadow: 0 6px 14px rgba(0,77,64,.5);
  }
  main {
    background: white;
    border-radius: 14px;
    padding: 32px 38px;
    margin: 24px 12px 80px;
    box-shadow: 0 12px 35px rgba(0,77,64,.3);
    max-width: 720px;
    width: 100%;
  }
  .step {
    display: none;
    flex-direction: column;
  }
  .step.active {
    display: flex;
  }
  label {
    font-weight: 700;
    font-size: 22px;
    color: #00695c;
    margin-top: 20px;
  }
  input[type=text], input[type=number], select {
    padding: 14px 18px;
    border-radius: 10px;
    border: 2px solid #b2dfdb;
    background-color: #e0f2f1;
    color: #004d40;
    font-weight: 700;
    font-size: 18px;
    margin-top: 8px;
  }
  select {
    cursor: pointer;
  }
  input[type=text] {
    cursor: text;
  }
  input:focus, select:focus {
    outline: none;
    border-color: #004d40;
    background-color: #c8e6c9;
  }
  .nav-buttons {
    margin-top: 28px;
    display: flex;
    justify-content: space-between;
  }
  .nav-buttons button {
    width: 48%;
    font-size: 18px;
    font-weight: 900;
    padding: 14px 0;
    border-radius: 12px;
    border: none;
    background-color: #00796b;
    color: white;
    cursor: pointer;
    box-shadow: 0 6px 15px rgba(0,121,107,0.6);
    transition: background-color 0.3s ease;
  }
  .nav-buttons button:disabled {
    background-color: #a5d6a7;
    cursor: default;
    box-shadow: none;
  }
  .nav-buttons button:hover:not(:disabled) {
    background-color: #004d40;
    box-shadow: 0 8px 20px rgba(0,77,64,0.9);
  }
  #result {
    margin-top: 40px;
    background-color: #b2dfdb;
    border-radius: 16px;
    padding: 24px;
    font-weight: 700;
    color: #004d40;
    font-size: 22px;
    line-height: 1.6;
    white-space: pre-line;
  }
  footer {
    position: fixed;
    bottom: 0; left: 0;
    width: 100%;
    background-color: #004d40;
    color: #a7c7c4;
    font-weight: 600;
    font-size: 14px;
    padding: 16px 12px;
    text-align: center;
    user-select: none;
  }
</style>
</head>
<body>
<header>Ø³Ø±Ø¹Ø© ØªÙ…Ù„Ùƒ Ø§Ù„Ø¹Ù‚Ø§Ø± ÙˆØ§Ù„Ø­Ù„ÙˆÙ„ Ø§Ù„ØªÙ…ÙˆÙŠÙ„ÙŠØ©</header>
<main>
  <!-- Ø®Ø·ÙˆØ© 1: Ø§Ø³Ù… Ø§Ù„Ø¹Ù…ÙŠÙ„ -->
  <section class="step active" id="step-name">
    <label for="clientName">Ø§Ø³Ù…Ùƒ Ø§Ù„ÙƒØ±ÙŠÙ…:</label>
    <input type="text" id="clientName" placeholder="Ø£Ø¯Ø®Ù„ Ø§Ø³Ù…Ùƒ Ø§Ù„ÙƒØ±ÙŠÙ…" autocomplete="off" />
    <div class="nav-buttons">
      <button id="name-prev" disabled>Ø§Ù„Ø³Ø§Ø¨Ù‚</button>
      <button id="name-next" disabled>Ø§Ù„ØªØ§Ù„ÙŠ</button>
    </div>
  </section>

  <!-- Ø®Ø·ÙˆØ© 2: Ù†ÙˆØ¹ Ø§Ù„ØªÙ…ÙˆÙŠÙ„ -->
  <section class="step" id="step-financeType">
    <label for="financeType">Ø§Ø®ØªØ± Ù†ÙˆØ¹ Ø§Ù„ØªÙ…ÙˆÙŠÙ„:</label>
    <select id="financeType">
      <option value="">-- Ø§Ø®ØªØ± --</option>
      <option value="real">ØªÙ…ÙˆÙŠÙ„ Ø¹Ù‚Ø§Ø±ÙŠ</option>
      <option value="personal">ØªÙ…ÙˆÙŠÙ„ Ø´Ø®ØµÙŠ</option>
    </select>
    <div class="nav-buttons">
      <button id="finance-prev">Ø§Ù„Ø³Ø§Ø¨Ù‚</button>
      <button id="finance-next" disabled>Ø§Ù„ØªØ§Ù„ÙŠ</button>
    </div>
  </section>

  <!-- Ø®Ø·ÙˆØ© 3: Ù†ÙˆØ¹ Ø§Ù„ÙˆØ¸ÙŠÙØ© -->
  <section class="step" id="step-jobType">
    <label for="jobType">Ù†ÙˆØ¹ Ø§Ù„ÙˆØ¸ÙŠÙØ©:</label>
    <select id="jobType">
      <option value="">-- Ø§Ø®ØªØ± --</option>
      <option value="military">Ø¹Ø³ÙƒØ±ÙŠ</option>
      <option value="civil">Ù…Ø¯Ù†ÙŠ</option>
      <option value="private">Ø®Ø§Øµ</option>
    </select>
    <div class="nav-buttons">
      <button id="job-prev">Ø§Ù„Ø³Ø§Ø¨Ù‚</button>
      <button id="job-next" disabled>Ø§Ù„ØªØ§Ù„ÙŠ</button>
    </div>
  </section>

  <!-- Ø®Ø·ÙˆØ© 4: ØªØ§Ø±ÙŠØ® Ø§Ù„Ù…ÙŠÙ„Ø§Ø¯ Ø§Ù„Ù‡Ø¬Ø±ÙŠ -->
  <section class="step" id="step-birth">
    <label>ØªØ§Ø±ÙŠØ® Ø§Ù„Ù…ÙŠÙ„Ø§Ø¯ Ø§Ù„Ù‡Ø¬Ø±ÙŠ:</label>
    <select id="birthYear"><option value="">Ø³Ù†Ø©</option></select>
    <select id="birthMonth"><option value="">Ø´Ù‡Ø±</option></select>
    <select id="birthDay"><option value="">ÙŠÙˆÙ…</option></select>
    <div class="nav-buttons">
      <button id="birth-prev">Ø§Ù„Ø³Ø§Ø¨Ù‚</button>
      <button id="birth-next" disabled>Ø§Ù„ØªØ§Ù„ÙŠ</button>
    </div>
  </section>

  <!-- Ø®Ø·ÙˆØ© 5: Ø§Ù„Ø±ØªØ¨Ø© Ø§Ù„Ø¹Ø³ÙƒØ±ÙŠØ© (ØªØ¸Ù‡Ø± ÙÙ‚Ø· Ù„Ù„Ø¹Ø³ÙƒØ±ÙŠ) -->
  <section class="step" id="step-rank" style="display:none;">
    <label for="rank">Ø±ØªØ¨ØªÙƒ Ø§Ù„Ø¹Ø³ÙƒØ±ÙŠØ©:</label>
    <select id="rank">
      <option value="">-- Ø§Ø®ØªØ± --</option>
      <option>Ø¬Ù†Ø¯ÙŠ</option><option>Ø¬Ù†Ø¯ÙŠ Ø£ÙˆÙ„</option><option>Ø¹Ø±ÙŠÙ</option><option>ÙˆÙƒÙŠÙ„ Ø±Ù‚ÙŠØ¨</option>
      <option>Ø±Ù‚ÙŠØ¨</option><option>Ø±Ù‚ÙŠØ¨ Ø£ÙˆÙ„</option><option>Ø±Ø¦ÙŠØ³ Ø±Ù‚Ø¨Ø§Ø¡</option><option>Ù…Ù„Ø§Ø²Ù…</option>
      <option>Ù…Ù„Ø§Ø²Ù… Ø£ÙˆÙ„</option><option>Ù†Ù‚ÙŠØ¨</option><option>Ø±Ø§Ø¦Ø¯</option><option>Ù…Ù‚Ø¯Ù…</option>
      <option>Ø¹Ù‚ÙŠØ¯</option><option>Ø¹Ù…ÙŠØ¯</option><option>Ù„ÙˆØ§Ø¡</option>
    </select>
    <div class="nav-buttons">
      <button id="rank-prev">Ø§Ù„Ø³Ø§Ø¨Ù‚</button>
      <button id="rank-next" disabled>Ø§Ù„ØªØ§Ù„ÙŠ</button>
    </div>
  </section>

  <!-- Ø®Ø·ÙˆØ© 6: Ø§Ù„Ø±Ø§ØªØ¨ Ø§Ù„ØµØ§ÙÙŠ -->
  <section class="step" id="step-netSalary">
    <label for="netSalary">Ø§Ù„Ø±Ø§ØªØ¨ Ø§Ù„ØµØ§ÙÙŠ Ø§Ù„Ø­Ø§Ù„ÙŠ (Ø±ÙŠØ§Ù„):</label>
    <input type="number" id="netSalary" min="0" />
    <div class="nav-buttons">
      <button id="salary-prev">Ø§Ù„Ø³Ø§Ø¨Ù‚</button>
      <button id="salary-next" disabled>Ø§Ù„ØªØ§Ù„ÙŠ</button>
    </div>
  </section>

  <!-- Ø®Ø·ÙˆØ© 7: Ù…Ø¯Ø© Ø§Ù„ØªÙ…ÙˆÙŠÙ„ -->
  <section class="step" id="step-months">
    <label for="months">Ù…Ø¯Ø© Ø§Ù„ØªÙ…ÙˆÙŠÙ„ (Ø´Ù‡ÙˆØ±):</label>
    <select id="months">
      <option value="">-- Ø§Ø®ØªØ± --</option>
    </select>
    <div class="nav-buttons">
      <button id="months-prev">Ø§Ù„Ø³Ø§Ø¨Ù‚</button>
      <button id="months-next" disabled>Ø§Ù„ØªØ§Ù„ÙŠ</button>
    </div>
  </section>

  <!-- Ø®Ø·ÙˆØ© 8: Ù‡Ø§Ù…Ø´ Ø§Ù„Ø±Ø¨Ø­ -->
  <section class="step" id="step-profitMargin">
    <label for="profitMargin">Ù†Ø³Ø¨Ø© Ù‡Ø§Ù…Ø´ Ø§Ù„Ø±Ø¨Ø­ Ø§Ù„Ø³Ù†ÙˆÙŠ (%):</label>
    <input type="number" id="profitMargin" min="0" />
    <div class="nav-buttons">
      <button id="profit-prev">Ø§Ù„Ø³Ø§Ø¨Ù‚</button>
      <button id="profit-next" disabled>Ø§Ø­Ø³Ø¨</button>
    </div>
  </section>

  <!-- Ø®Ø·ÙˆØ© 9: Ø§Ù„Ø­Ø³Ø¨Ø© Ø§Ù„Ù…Ù…ØªØ¯Ø© (ØªØ¸Ù‡Ø± Ø­Ø³Ø¨ Ø´Ø±ÙˆØ·) -->
  <section class="step" id="step-extended" style="display:none;">
    <label for="extendedCalc">Ù‡Ù„ ØªØ±ØºØ¨ Ø¨Ø§Ù„Ø­Ø³Ø¨Ø© Ø¹Ù„Ù‰ Ø§Ù„ØªÙ‚Ø§Ø¹Ø¯ Ø§Ù„Ù…Ù…ØªØ¯ØŸ</label>
    <select id="extendedCalc">
      <option value="">-- Ø§Ø®ØªØ± --</option>
      <option value="yes">Ù†Ø¹Ù…</option>
      <option value="no">Ù„Ø§</option>
    </select>
    <div class="nav-buttons">
      <button id="ext-prev">Ø§Ù„Ø³Ø§Ø¨Ù‚</button>
      <button id="ext-next" disabled>Ø§Ø­Ø³Ø¨</button>
    </div>
  </section>

  <!-- Ø®Ø·ÙˆØ© 10: Ø¹Ø±Ø¶ Ø§Ù„Ù†ØªÙŠØ¬Ø© -->
  <section class="step" id="step-result" style="white-space: pre-line;">
    <h2>Ù†ØªÙŠØ¬Ø© Ø§Ù„Ø­Ø³Ø¨Ø©:</h2>
    <div id="result"></div>
    <button id="resetBtn">Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ø­Ø³Ø¨Ø©</button>
  </section>
</main>

<footer>
  ğŸ“… Ù‡Ø¬Ø±ÙŠ: <span id="hijri"></span> | Ù…ÙŠÙ„Ø§Ø¯ÙŠ: <span id="greg"></span><br />
  Â© Ø³Ø±Ø¹Ø© ØªÙ…Ù„Ùƒ Ø§Ù„Ø¹Ù‚Ø§Ø± ÙˆØ§Ù„Ø­Ù„ÙˆÙ„ Ø§Ù„ØªÙ…ÙˆÙŠÙ„ÙŠØ©
</footer>

<script>
  // ØªØ¹Ø¨Ø¦Ø© Ø³Ù†ÙˆØ§Øª ÙˆØ´Ù‡ÙˆØ± ÙˆØ£ÙŠØ§Ù… Ø§Ù„Ù…ÙŠÙ„Ø§Ø¯ Ø§Ù„Ù‡Ø¬Ø±ÙŠ
  const birthYearSel = document.getElementById('birthYear');
  const birthMonthSel = document.getElementById('birthMonth');
  const birthDaySel = document.getElementById('birthDay');
  function fillBirthDateSelectors(){
    for(let y=1370; y<=1446; y++){
      const opt = document.createElement('option');
      opt.value = y; opt.textContent = y; birthYearSel.appendChild(opt);
    }
    for(let m=1; m<=12; m++){
      const opt = document.createElement('option');
      opt.value = m; opt.textContent = m.toString().padStart(2,'0'); birthMonthSel.appendChild(opt);
    }
    for(let d=1; d<=30; d++){
      const opt = document.createElement('option');
      opt.value = d; opt.textContent = d.toString().padStart(2,'0'); birthDaySel.appendChild(opt);
    }
  }
  fillBirthDateSelectors();

  // Ø¹Ø±Ø¶ Ø§Ù„ØªØ§Ø±ÙŠØ® ÙÙŠ Ø§Ù„ÙÙˆØªØ±
  const today = new Date();
  document.getElementById('greg').innerText = today.toLocaleDateString('ar-SA');
  document.getElementById('hijri').innerText = new Intl.DateTimeFormat('ar-SA-u-ca-islamic',{year:'numeric',month:'long',day:'numeric'}).format(today);

  // Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ØªÙ‚Ø§Ø¹Ø¯ ÙˆØ§Ù„Ø±ÙØªØ¨
  const retireAges = {
    'Ø¬Ù†Ø¯ÙŠ':44,'Ø¬Ù†Ø¯ÙŠ Ø£ÙˆÙ„':44,'Ø¹Ø±ÙŠÙ':46,'ÙˆÙƒÙŠÙ„ Ø±Ù‚ÙŠØ¨':48,'Ø±Ù‚ÙŠØ¨':48,
    'Ø±Ù‚ÙŠØ¨ Ø£ÙˆÙ„':50,'Ø±Ø¦ÙŠØ³ Ø±Ù‚Ø¨Ø§Ø¡':52,'Ù…Ù„Ø§Ø²Ù…':48,'Ù…Ù„Ø§Ø²Ù… Ø£ÙˆÙ„':50,
    'Ù†Ù‚ÙŠØ¨':52,'Ø±Ø§Ø¦Ø¯':54,'Ù…Ù‚Ø¯Ù…':56,'Ø¹Ù‚ÙŠØ¯':58,'Ø¹Ù…ÙŠØ¯':60,'Ù„ÙˆØ§Ø¡':60
  };
  const salaryGrades = {
    'Ø¬Ù†Ø¯ÙŠ':{base:3220,inc:125},'Ø¬Ù†Ø¯ÙŠ Ø£ÙˆÙ„':{base:3395,inc:135},
    'Ø¹Ø±ÙŠÙ':{base:3715,inc:140},'ÙˆÙƒÙŠÙ„ Ø±Ù‚ÙŠØ¨':{base:4000,inc:150},
    'Ø±Ù‚ÙŠØ¨':{base:4370,inc:160},'Ø±Ù‚ÙŠØ¨ Ø£ÙˆÙ„':{base:4700,inc:165},
    'Ø±Ø¦ÙŠØ³ Ø±Ù‚Ø¨Ø§Ø¡':{base:4950,inc:170},'Ù…Ù„Ø§Ø²Ù…':{base:8835,inc:275},
    'Ù…Ù„Ø§Ø²Ù… Ø£ÙˆÙ„':{base:9715,inc:350},'Ù†Ù‚ÙŠØ¨':{base:11940,inc:450},
    'Ø±Ø§Ø¦Ø¯':{base:14155,inc:500},'Ù…Ù‚Ø¯Ù…':{base:16400,inc:600},
    'Ø¹Ù‚ÙŠØ¯':{base:18800,inc:700},'Ø¹Ù…ÙŠØ¯':{base:22000,inc:800},'Ù„ÙˆØ§Ø¡':{base:23500,inc:900}
  };

  // Ø§Ù„ØªÙ†Ù‚Ù„ Ø¨ÙŠÙ† Ø§Ù„Ø®Ø·ÙˆØ§Øª ÙˆØ§Ù„ØªÙ…ÙƒÙŠÙ†
  const steps = [
    'step-name','step-financeType','step-jobType','step-birth','step-rank',
    'step-netSalary','step-months','step-profitMargin','step-extended','step-result'
  ];
  let currentStep = 0;

  function showStep(index){
    steps.forEach((id,i)=>{
      const el=document.getElementById(id);
      el.style.display = (i === index) ? 'flex' : 'none';
      el.classList.toggle('active', i === index);
    });
    currentStep = index;
    enableNextIfValid();
  }

  function enableNextIfValid(){
    let valid=false;
    switch(steps[currentStep]){
      case 'step-name':
        valid = !!document.getElementById('clientName').value.trim();
        document.getElementById('name-next').disabled = !valid;
        break;
      case 'step-financeType':
        valid = !!document.getElementById('financeType').value;
        document.getElementById('finance-next').disabled = !valid;
        break;
      case 'step-jobType':
        valid = !!document.getElementById('jobType').value;
        document.getElementById('job-next').disabled = !valid;
        break;
      case 'step-birth':
        valid = !!birthYearSel.value && !!birthMonthSel.value && !!birthDaySel.value;
        document.getElementById('birth-next').disabled = !valid;
        break;
      case 'step-rank':
        if(document.getElementById('step-rank').style.display==='flex'){
          valid = !!document.getElementById('rank').value;
          document.getElementById('rank-next').disabled = !valid;
        } else {
          valid = true; // Skip rank validation if not visible
          document.getElementById('rank-next').disabled = true;
        }
        break;
      case 'step-netSalary':
        let sal=parseFloat(document.getElementById('netSalary').value);
        valid = !isNaN(sal) && sal > 0;
        document.getElementById('salary-next').disabled = !valid;
        break;
      case 'step-months':
        valid = !!document.getElementById('months').value;
        document.getElementById('months-next').disabled = !valid;
        break;
      case 'step-profitMargin':
        let prof=parseFloat(document.getElementById('profitMargin').value);
        valid = !isNaN(prof) && prof >= 0;
        document.getElementById('profit-next').disabled = !valid;
        break;
      case 'step-extended':
        valid = !!document.getElementById('extendedCalc').value;
        document.getElementById('ext-next').disabled = !valid;
        break;
      default:
        valid = true;
    }
  }

  // Ø¥Ø¶Ø§ÙØ© Ø£Ø­Ø¯Ø§Ø« ØªÙ…ÙƒÙŠÙ† Ø²Ø± Ø§Ù„ØªØ§Ù„ÙŠ
  [
    'clientName','financeType','jobType','birthYear','birthMonth','birthDay',
    'rank','netSalary','months','profitMargin','extendedCalc'
  ].forEach(id=>{
    const el = document.getElementById(id);
    if(el){
      el.addEventListener('input', enableNextIfValid);
      el.addEventListener('change', enableNextIfValid);
    }
  });

  // Ø²Ø± Ø§Ù„ØªÙ†Ù‚Ù„ Ø¨ÙŠÙ† Ø§Ù„Ø®Ø·ÙˆØ§Øª
  document.getElementById('name-prev').onclick = () => showStep(0);
  document.getElementById('name-next').onclick = () => showStep(1);

  document.getElementById('finance-prev').onclick = () => showStep(0);
  document.getElementById('finance-next').onclick = () => showStep(2);

  document.getElementById('job-prev').onclick = () => showStep(1);
  document.getElementById('job-next').onclick = () => {
    const jobVal = document.getElementById('jobType').value;
    if(jobVal === 'military'){
      document.getElementById('step-rank').style.display = 'flex';
      showStep(4);
    } else {
      document.getElementById('step-rank').style.display = 'none';
      showStep(5);
    }
  };

  document.getElementById('birth-prev').onclick = () => {
    const jobVal = document.getElementById('jobType').value;
    if(jobVal === 'military') showStep(4);
    else showStep(2);
  };
  document.getElementById('birth-next').onclick = () => showStep(5);

  document.getElementById('rank-prev').onclick = () => showStep(3);
  document.getElementById('rank-next').onclick = () => showStep(5);

  document.getElementById('salary-prev').onclick = () => {
    const jobVal = document.getElementById('jobType').value;
    if(jobVal === 'military') showStep(4);
    else showStep(3);
  };
  document.getElementById('salary-next').onclick = () => {
    fillMonthsBasedOnFinance();
    showStep(6);
  };

  document.getElementById('months-prev').onclick = () => showStep(5);
  document.get