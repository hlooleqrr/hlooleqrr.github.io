<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>شركة سرعة تملك العقار - حاسبة التمويل الشخصي</title>
    <style>
        body {
            font-family: 'Tajawal', sans-serif;
            background: #f7f7f7;
            margin: 0;
            padding: 0;
            text-align: center;
        }
        .container {
            max-width: 600px;
            margin: auto;
            background: white;
            padding: 30px;
            border-radius: 8px;
            margin-top: 30px;
            box-shadow: 0 0 10px rgba(0,0,0,0.1);
        }
        input, select, button {
            width: 100%;
            padding: 10px;
            margin: 10px 0;
            font-size: 1em;
        }
        button {
            background-color: #007b5f;
            color: white;
            border: none;
            border-radius: 5px;
        }
        footer {
            margin-top: 30px;
            font-size: 0.8em;
            color: #555;
            text-align: left;
            padding: 10px;
        }
    </style>
</head>
<body>

    <h1>شركة سرعة تملك العقار</h1>

    <div class="container" id="form-container">
        <div id="question"></div>
        <button onclick="nextQuestion()">التالي</button>
    </div>

    <footer>
        <p>جميع الحقوق محفوظة لشركة سرعة تملك العقار - <span id="datetime"></span></p>
    </footer>

    <script>
        const questions = [
            {q: "ادخل اسمك الكامل:", id: "name", type: "text"},
            {q: "ادخل اسم البنك الذي ينزل عليه راتبك:", id: "bank", type: "text"},
            {q: "ما هو الراتب الشهري؟", id: "salary", type: "number"},
            {q: "هل عليك التزامات؟", id: "hasCommitments", type: "select", options: ["لا", "نعم"]},
            {q: "نوع الالتزام:", id: "commitmentType", type: "select", options: ["قرض سيارة", "قرض استهلاكي"]},
            {q: "ما هو قسط الالتزام الشهري؟", id: "commitmentPayment", type: "number"},
            {q: "عدد الأشهر المتبقية للالتزام:", id: "commitmentMonths", type: "number"},
            {q: "إذا كان الالتزام قرض سيارة، قيمة الدفعة الأخيرة (إن وجدت):", id: "lastPayment", type: "number"}
        ];

        let answers = {};
        let current = 0;

        function nextQuestion() {
            const container = document.getElementById("question");
            const btn = document.querySelector("button");

            // حفظ إجابة السؤال السابق
            if (current > 0) {
                const prevId = questions[current-1].id;
                const input = document.getElementById(prevId);
                if (input) {
                    if (input.type === "select-one") {
                        answers[prevId] = input.value;
                    } else {
                        answers[prevId] = input.value.trim();
                    }
                }
                // إذا كان الجواب بلا التزامات، تجاوز أسئلة الالتزام
                if (prevId === "hasCommitments" && answers["hasCommitments"] === "لا") {
                    answers["commitmentType"] = "لا يوجد";
                    answers["commitmentPayment"] = 0;
                    answers["commitmentMonths"] = 0;
                    answers["lastPayment"] = 0;
                }
            }

            if (current >= questions.length) {
                calculateFinance();
                btn.style.display = "none";
                return;
            }

            // تجاوز أسئلة الالتزام إذا لم يكن هناك التزام
            if (answers["hasCommitments"] === "لا") {
                const skipIDs = ["commitmentType", "commitmentPayment", "commitmentMonths", "lastPayment"];
                while (current < questions.length && skipIDs.includes(questions[current].id)) {
                    const qid = questions[current].id;
                    if (qid === "commitmentType") {
                        answers[qid] = "لا يوجد";
                    } else {
                        answers[qid] = 0;
                    }
                    current++;
                }
                if (current >= questions.length) {
                    calculateFinance();
                    btn.style.display = "none";
                    return;
                }
            }

            const q = questions[current];
            let html = `<label>${q.q}</label><br>`;
            if (q.type === "select") {
                html += `<select id="${q.id}">`;
                q.options.forEach(opt => {
                    html += `<option value="${opt}">${opt}</option>`;
                });
                html += `</select>`;
            } else {
                html += `<input type="${q.type}" id="${q.id}" required>`;
            }
            container.innerHTML = html;
            current++;
        }

        function calculateFinance() {
            const salary = parseFloat(answers.salary) || 0;
            const hasCommitments = answers.hasCommitments === "نعم";
            const monthlyCommitment = hasCommitments ? (parseFloat(answers.commitmentPayment) || 0) : 0;

            // الحد الأقصى للاستقطاع (45% من الراتب)
            const maxDeduction = salary * 0.45;
            // القسط خلال مدة الالتزام
            let installmentDuring = maxDeduction - monthlyCommitment;
            if (installmentDuring < 0) {
                installmentDuring = 0;
            }
            const maxPersonal = salary * 0.3333;
            if (installmentDuring > maxPersonal) {
                installmentDuring = maxPersonal;
            }
            // القسط بعد انتهاء الالتزام (33.33% من الراتب)
            const installmentAfter = maxPersonal;

            document.getElementById("question").innerHTML = `
                <h3>نتائج التمويل الشخصي:</h3>
                <p>القسط خلال مدة الالتزام: <strong>${installmentDuring.toFixed(2)}</strong> ريال</p>
                <p>القسط بعد انتهاء الالتزام: <strong>${installmentAfter.toFixed(2)}</strong> ريال</p>
                <p>شكراً لك، سيتم التواصل معك قريباً!</p>
            `;
        }

        function updateDateTime() {
            const now = new Date();
            const year = now.getFullYear();
            const month = String(now.getMonth() + 1).padStart(2, '0');
            const day = String(now.getDate()).padStart(2, '0');
            const hours = String(now.getHours()).padStart(2, '0');
            const minutes = String(now.getMinutes()).padStart(2, '0');
            const seconds = String(now.getSeconds()).padStart(2, '0');
            document.getElementById('datetime').innerText =
                `${year}-${month}-${day} ${hours}:${minutes}:${seconds}`;
        }

        setInterval(updateDateTime, 1000);
        updateDateTime();
        nextQuestion();
    </script>

</body>
</html>